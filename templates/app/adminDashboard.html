{% extends 'base.html' %} {% load static %} {% block content %}

<!-- for registered users search bar -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

<div class="container">
  <div class="jumbotron text-center" style="background-color: #c1e9f3">
    <h2><b>ADMINISTRATOR DASHBOARD</b></h2>
  </div>
</div>
<br />
<div class="container">
  <div class="row-sm-4">
    <div class="text-left">
      <div class="mb-3">
        <h3><b>Registered Users</b></h3>
      </div>
      <input
        class="form-control"
        id="id-admin-input"
        type="text"
        placeholder="Search"
      />
      <table
        id="id-users-list"
        class="table table-striped table-bordered table-sm table-hover"
        cellspacing="0"
        width="100%"
        style="background-color: #e9fbff"
      >
        <thead>
          <tr style="text-align: center">
            <th class="th-sm">ID</th>
            <th class="th-sm">Date Registered</th>
            <th class="th-sm">Username</th>
            <th class="th-sm">User Type</th>
          </tr>
        </thead>

        <tbody id="id-users-table">
          {% for user in users %}
          <tr style="text-align: center">
            <td>{{user.id}}</td>
            <td>{{user.date_joined}}</td>
            <td>{{user.username}}</td>
            {% if user.is_superuser %}
            <td>Admin</td>
            {% elif user.is_staff %}
            <td>Organizer</td>
            {% else %}
            <td>Regular User</td>
            {% endif %}
          </tr>
          {% endfor %}
        </tbody>

        <tfoot>
          <tr style="text-align: center">
            <th>ID</th>
            <th>Date Registered</th>
            <th>Username</th>
            <th>User Type</th>
          </tr>
        </tfoot>
      </table>

      <br /><br />
      <div class="d-flex justify-content-between mb-3">
        <h3><b>Events</b></h3>
        <button type="button" class="btn btn-primary">Create Event</button>
      </div>
      <input
        class="form-control"
        id="id-event-input"
        type="text"
        placeholder="Search"
      />

      <table
        id="id-events-list"
        class="table table-bordered"
        cellspacing="0"
        width="100%"
        style="background-color: #e9fbff"
      >
        <thead>
          <tr style="text-align: center">
            <th class="th-sm">Title</th>
            <th class="th-sm">Type</th>
            <th class="th-sm">Description</th>
            <th class="th-sm">Start Date</th>
            <th class="th-sm">End Date</th>
            <th class="th-sm">Action</th>
          </tr>
        </thead>
        <tbody id="id-events-table">
          {% for event in events %}
          <tr style="text-align: center">
            <td>{{event.title}}</td>
            <td>{{event.type}}</td>
            <td>{{event.description}}</td>
            <td>{{event.datetime_start}}</td>
            <td>{{event.datetime_end}}</td>
            <td>
              <button
                type="button"
                class="btn btn-primary"
                data-toggle="modal"
                data-target="#ModalView"
              >
                View
              </button>
              <button
                type="submit"
                class="btn btn-primary"
                data-toggle="modal"
                data-target="#ModalDelete"
              >
                Delete
              </button>
            </td>
          </tr>
          {% endfor %}
          <!-- Modal View-->
          <div
            class="modal fade"
            id="ModalView"
            tabindex="-1"
            role="dialog"
            aria-labelledby="exampleModalLabel"
            aria-hidden="true"
          >
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h2 class="modal-title" id="id-modal-view">Update Event</h2>
                  <button
                    type="button"
                    class="close"
                    data-dismiss="modal"
                    aria-label="Close"
                  >
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>

                <form id="UpdateEventForm" method="POST">
                  {% csrf_token %}

                  <div class="modal-body">
                    <div class="row">
                      <div class="col-sm-6">
                        <label>Event Title</label>
                        <input
                          type="text"
                          class="form-control"
                          id="id-event-title"
                          name="eventtitle"
                          placeholder="Event Title"
                          required="required"
                        />
                      </div>
                      <div class="col-sm-6">
                        <label>Event Type</label>
                        <select
                          name="eventtype"
                          id="id-event-type"
                          class="form-select form-select-md"
                          aria-label=".form-select-md example"
                        >
                          <option selected>Open this select menu</option>
                          <option value="1">Trail Biking</option>
                          <option value="2">Basketball</option>
                          <option value="3">Zumba</option>
                          <option value="3">Univercity</option>
                          <option value="3">Run-for-a-cause</option>
                        </select>
                      </div>
                    </div>
                    <br />
                    <div class="row">
                      <div class="col-sm-12">
                        <label>Description</label>
                        <input
                          type="text"
                          class="form-control"
                          id="id-description"
                          name="description"
                          placeholder="Description"
                          required="required"
                        />
                      </div>
                    </div>
                    <br />
                    <div class="row">
                      <div class="col-sm-5">
                        <label>Start Date</label>
                        <input
                          type="date"
                          class="form-control"
                          id="id-start-date"
                          name="startdate"
                          required="required"
                        />
                      </div>
                      <div class="col-sm-5">
                        <label>End Date</label>
                        <input
                          type="date"
                          class="form-control"
                          id="id-end-date"
                          name="enddate"
                          required="required"
                        />
                      </div>
                      <div class="col-sm-2">
                        <label>Upvotes</label>
                        <input
                          type="text"
                          class="form-control"
                          id="id-upvotes"
                          name="upvotes"
                        />
                      </div>
                    </div>
                  </div>
                  <!--modal-body-->

                  <div class="modal-footer">
                    <button
                      type="button"
                      class="btn btn-secondary"
                      data-dismiss="modal"
                    >
                      Cancel
                    </button>
                    <button
                      type="submit"
                      id="UpdateBtn"
                      name="UpdateBtn"
                      class="btn btn-primary"
                    >
                      Update
                    </button>
                  </div>
                </form>
              </div>
            </div>
          </div>
          <!-- Modal View Ends -->

          <!-- Modal Delete -->
          <div
            class="modal fade"
            id="ModalDelete"
            tabindex="-1"
            role="dialog"
            aria-labelledby="exampleModalLabel"
            aria-hidden="true"
          >
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h2 class="modal-title" id="id-modal-delete">DELETE EVENT</h2>
                  <button
                    type="button"
                    class="close"
                    data-dismiss="modal"
                    aria-label="Close"
                  >
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>

                <form id="DeleteEventForm" method="post">
                  {% csrf_token %}

                  <div class="modal-body">
                    <input type="text" name="eventID" hidden />
                    Are you sure you want to delete this customer?
                  </div>

                  <div class="modal-footer">
                    <button
                      type="button"
                      class="btn btn-secondary"
                      data-dismiss="modal"
                    >
                      No
                    </button>
                    <button
                      type="submit"
                      id="DeleteBtn"
                      name="DeleteBtn"
                      class="btn btn-primary"
                    >
                      Yes
                    </button>
                  </div>
                </form>
              </div>
            </div>
          </div>
          <!-- Modal Delete Ends -->
        </tbody>

        <tfoot>
          <tr style="text-align: center">
            <th class="th-sm">Title</th>
            <th class="th-sm">Type</th>
            <th class="th-sm">Description</th>
            <th class="th-sm">Start Date</th>
            <th class="th-sm">End Date</th>
            <th class="th-sm">Action</th>
          </tr>
        </tfoot>
      </table>

      <br /><br />

      <div class="mb-3">
        <h3><b>Organizer Requests</b></h3>
      </div>
      <input
        class="form-control"
        id="id-request-input"
        type="text"
        placeholder="Search"
      />
      <table
        id="id-organizer-request"
        class="table table-striped table-bordered table-sm table-hover"
        cellspacing="0"
        width="100%"
        style="background-color: #e9fbff"
      >
        <thead>
          <tr style="text-align: center">
            <th class="th-sm">ID</th>
            <th>Username</th>
            <th class="th-sm">Date Registered</th>
            <th class="th-sm">Action</th>
          </tr>
        </thead>

        <tbody id="id-orgRequest-table">
          <!--  backend code here -->
          {% if requests %} {% for request in requests %}
          <tr style="text-align: center">
            <td>{{request.id}}</td>
            <td>{{request.user}}</td>
            <td>{{request.datetime_request}}</td>
            <td>
              <div class="text-center">
                <form method="POST" enctype="multipart/form-data">
                  {% csrf_token %}
                  <input
                    type="number"
                    name="request-id"
                    value="{{request.id}}"
                    hidden
                  />
                  <button
                    name="denyOrg"
                    type="submit"
                    class="btn btn-secondary"
                    data-toggle="modal"
                    data-target="#modalRequestToJoin"
                  >
                    Deny
                  </button>
                  <button
                    name="acceptOrg"
                    type="submit"
                    class="btn btn-primary"
                    data-toggle="modal"
                    data-target="#modalRequestToJoin"
                  >
                    Accept
                  </button>
                </form>
              </div>
            </td>
          </tr>
          {% endfor %} {% else %}
          <tr style="text-align: center">
            <td>No Requests</td>
            <td>No Requests</td>
            <td>No Requests</td>
            <td>No Requests</td>
          </tr>
          {% endif %}
        </tbody>

        <tfoot>
          <tr style="text-align: center">
            <th>ID</th>
            <th>Username</th>
            <th>Date Registered</th>
            <th class="th-sm">Action</th>
          </tr>
        </tfoot>
      </table>

      <script>
        $(document).ready(function () {
          $("#id-admin-input").on("keyup", function () {
            var value = $(this).val().toLowerCase();
            $("#id-users-table tr").filter(function () {
              $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1);
            });
          });
        });
      </script>

      <script>
        $(document).ready(function () {
          $("#id-event-input").on("keyup", function () {
            var value = $(this).val().toLowerCase();
            $("#id-events-table tr").filter(function () {
              $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1);
            });
          });
        });
      </script>

      <script>
        $(document).ready(function () {
          $("#id-request-input").on("keyup", function () {
            var value = $(this).val().toLowerCase();
            $("#id-orgRequest-table tr").filter(function () {
              $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1);
            });
          });
        });
      </script>

    </div>
  </div>
</div>

{% endblock content %}
